!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?module.exports=r(require("ethjs-provider-http"),require("ethjs-query"),require("ethjs-contract"),require("ethr-did-resolver/contracts/ethr-did-registry.json"),require("did-jwt"),require("buffer"),require("ethr-did-resolver")):"function"==typeof define&&define.amd?define(["ethjs-provider-http","ethjs-query","ethjs-contract","ethr-did-resolver/contracts/ethr-did-registry.json","did-jwt","buffer","ethr-did-resolver"],r):(e=e||self).ethrDid=r(e.ethjsProviderHttp,e.ethjsQuery,e.ethjsContract,e.DidRegistryContract,e.didJwt,e.buffer,e.ethrDidResolver)}(this,function(e,r,t,i,n,o,s){e=e&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e,r=r&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r,t=t&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t,i=i&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i;var u=new(0,require("elliptic").ec)("secp256k1"),d=s.delegateTypes.Secp256k1VerificationKey2018;function a(e,r){if(o.Buffer.isBuffer(r))return"0x"+r.toString("hex");var t=e.match(/^did\/(pub|auth|svc)\/(\w+)(\/(\w+))?(\/(\w+))?$/);return t&&"base64"===t[6]?"0x"+o.Buffer.from(r,"base64").toString("hex"):r.match(/^0x[0-9a-fA-F]*$/)?r:"0x"+o.Buffer.from(r).toString("hex")}return function(){function o(e){var o=this.configureProvider(e),u=new r(o),d=e.registry||s.REGISTRY,a=new t(u)(i);if(this.registry=a.at(d),this.address=e.address,!this.address)throw new Error("No address is set for EthrDid");this.did="did:ethr:"+this.address,e.signer?this.signer=e.signer:e.privateKey&&(this.signer=n.SimpleSigner(e.privateKey))}var c=o.prototype;return c.configureProvider=function(r){return r.provider?r.provider:r.web3?r.web3.currentProvider:new e(r.rpcUrl||"https://mainnet.infura.io/ethr-did")},o.createKeyPair=function(){var e=u.genKeyPair(),r=e.getPublic("hex"),t=e.getPrivate("hex");return{address:n.toEthereumAddress(r),privateKey:t}},c.lookupOwner=function(e){void 0===e&&(e=!0);try{return e&&this.owner?Promise.resolve(this.owner):Promise.resolve(this.registry.identityOwner(this.address)).then(function(e){return e[0]})}catch(e){return Promise.reject(e)}},c.changeOwner=function(e){try{var r=this;return Promise.resolve(r.lookupOwner()).then(function(t){return Promise.resolve(r.registry.changeOwner(r.address,e,{from:t})).then(function(t){return r.owner=e,t})})}catch(e){return Promise.reject(e)}},c.addDelegate=function(e,r){var t=r.delegateType,i=void 0===t?d:t,n=r.expiresIn,o=void 0===n?86400:n;try{var s=this;return Promise.resolve(s.lookupOwner()).then(function(r){return s.registry.addDelegate(s.address,i,e,o,{from:r})})}catch(e){return Promise.reject(e)}},c.revokeDelegate=function(e,r){void 0===r&&(r=d);try{var t=this;return Promise.resolve(t.lookupOwner()).then(function(i){return t.registry.revokeDelegate(t.address,r,e,{from:i})})}catch(e){return Promise.reject(e)}},c.setAttribute=function(e,r,t,i){void 0===t&&(t=86400);try{var n=this;return Promise.resolve(n.lookupOwner()).then(function(o){return n.registry.setAttribute(n.address,s.stringToBytes32(e),a(e,r),t,{from:o,gas:i})})}catch(e){return Promise.reject(e)}},c.revokeAttribute=function(e,r,t){try{var i=this;return Promise.resolve(i.lookupOwner()).then(function(n){return i.registry.revokeAttribute(i.address,s.stringToBytes32(e),a(e,r),{from:n,gas:t})})}catch(e){return Promise.reject(e)}},c.createSigningDelegate=function(e,r){void 0===e&&(e=d),void 0===r&&(r=86400);try{var t=o.createKeyPair();return this.signer=n.SimpleSigner(t.privateKey),Promise.resolve(this.addDelegate(t.address,{delegateType:e,expiresIn:r})).then(function(e){return{kp:t,txHash:e}})}catch(e){return Promise.reject(e)}},c.signJWT=function(e,r){try{if("function"!=typeof this.signer)throw new Error("No signer configured");var t={signer:this.signer,alg:"ES256K-R",issuer:this.did};return r&&(t.expiresIn=r),Promise.resolve(n.createJWT(e,t))}catch(e){return Promise.reject(e)}},c.verifyJWT=function(e,r,t){try{return void 0===t&&(t=this.did),Promise.resolve(n.verifyJWT(e,{resolver:r,audience:t}))}catch(e){return Promise.reject(e)}},o}()});
//# sourceMappingURL=index.umd.js.map
